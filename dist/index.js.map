{"version":3,"sources":["mayoralties.json","email-template.js","index.js"],"names":["module","exports","districts","mayoralty","twitter","facebook","whatsapp","cc","emailSubject","firstName","lastName","email","postcode","form","document","querySelector","gravityForm","style","display","addEventListener","e","preventDefault","formData","FormData","get","res","fetch","result","admin_district","json","mayoralties","find","m","includes","value","join","innerHTML","console","log"],"mappings":"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","file":"index.js","sourceRoot":"../src","sourcesContent":["module.exports=[{districts:[\"Manchester\",\"Wigan\",\"Bolton\",\"Bury\",\"Oldham\",\"Rochdale\",\"Salford\",\"Stockport\",\"Tameside\",\"Trafford\"],mayoralty:\"Greater Manchester\",twitter:\"https: //twitter.com/intent/tweet?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20Greater%20Manchester%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3&url=www.culturecommons.uk%2Fpledge\",facebook:\"https: //www.facebook.com/sharer/sharer.php?u=www.culturecommons.uk%2Fpledge?utm_source=facebook&utm_medium=social&utm_campaign=_fb\",whatsapp:\"https: //api.whatsapp.com/send?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20Greater%20Manchester%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3www.culturecommons.uk%2Fpledge\",cc:[\"example1@email.com\",\"example2@email.com\",\"example3@email.com\"],emailSubject:\"Will you support the creative industries in Greater Manchester?\"},{districts:[\"Liverpool\",\"St. Helens\",\"Sefton\",\"Knowsley\",\"Wirral\",\"Halton\"],mayoralty:\"Liverpool City Region\",twitter:\"https: //twitter.com/intent/tweet?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20the%20Liverpool%20City%20Region%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3&url=www.culturecommons.uk%2Fpledge\",facebook:\"https: //www.facebook.com/sharer/sharer.php?u=www.culturecommons.uk%2Fpledge?utm_source=facebook&utm_medium=social&utm_campaign=_fb\",whatsapp:\"https: //api.whatsapp.com/send?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20the%20Liverpool%20City%20Region%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3www.culturecommons.uk%2Fpledge\",cc:[\"example1@email.com\",\"example2@email.com\",\"example3@email.com\"],emailSubject:\"Will you support the creative industries in the Liverpool City Region?\"},{districts:[\"Leeds\",\"Bradford\",\"Calderdale\",\"Kirklees\",\"Wakefield\"],mayoralty:\"West Yorkshire\",twitter:\"https: //twitter.com/intent/tweet?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20West%20Yorkshire%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3&url=www.culturecommons.uk%2Fpledge\",facebook:\"https: //www.facebook.com/sharer/sharer.php?u=www.culturecommons.uk%2Fpledge?utm_source=facebook&utm_medium=social&utm_campaign=_fb\",whatsapp:\"https: //api.whatsapp.com/send?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20West%20Yorkshire%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3www.culturecommons.uk%2Fpledge\",cc:[\"example1@email.com\",\"example2@email.com\",\"example3@email.com\"],emailSubject:\"Will you support the creative industries in the West Yorkshire?\"},{districts:[\"Bristol\",\"Bath and North East Somerset\",\"South Gloucestershire\"],mayoralty:\"West of England\",twitter:\"https: //twitter.com/intent/tweet?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20the%20West%20of%20England%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3&url=www.culturecommons.uk%2Fpledge\",facebook:\"https: //www.facebook.com/sharer/sharer.php?u=www.culturecommons.uk%2Fpledge?utm_source=facebook&utm_medium=social&utm_campaign=_fb\",whatsapp:\"https: //api.whatsapp.com/send?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20the%20West%20of%20England%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3www.culturecommons.uk%2Fpledge\",cc:[\"example1@email.com\",\"example2@email.com\",\"example3@email.com\"],emailSubject:\"Will you support the creative industries in the West of England?\"},{districts:[\"Peterborough\",\"Cambridge\",\"East Cambridgeshire\",\"Fenland\",\"Huntingdonshire\",\"South Cambridgeshire\"],mayoralty:\"Cambridgeshire and Peterborough\",twitter:\"https: //twitter.com/intent/tweet?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20Cambridgeshire%20and%20Peterborough%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3&url=www.culturecommons.uk%2Fpledge\",facebook:\"https: //www.facebook.com/sharer/sharer.php?u=www.culturecommons.uk%2Fpledge?utm_source=facebook&utm_medium=social&utm_campaign=_fb\",whatsapp:\"https: //api.whatsapp.com/send?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20Cambridgeshire%20and%20Peterborough%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3www.culturecommons.uk%2Fpledge\",cc:[\"example1@email.com\",\"example2@email.com\",\"example3@email.com\"],emailSubject:\"Will you support the creative industries in Cambridgeshire and Peterborough?\"},{districts:[\"Birmingham\",\"Coventry\",\"Dudley\",\"Sandwell\",\"Solihull\",\"Walsall\",\"Wolverhampton\"],mayoralty:\"West Midlands\",twitter:\"https: //twitter.com/intent/tweet?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20the%20West%20Midlands%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3&url=www.culturecommons.uk%2Fpledge\",facebook:\"https: //www.facebook.com/sharer/sharer.php?u=www.culturecommons.uk%2Fpledge?utm_source=facebook&utm_medium=social&utm_campaign=_fb\",whatsapp:\"https: //api.whatsapp.com/send?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20the%20West%20Midlands%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3www.culturecommons.uk%2Fpledge\",cc:[\"example1@email.com\",\"example2@email.com\",\"example3@email.com\"],emailSubject:\"Will you support the creative industries in the West Midlands?\"},{districts:[\"Darlington\",\"Hartlepool\",\"Middlesbrough\",\"Redcar and Cleveland\",\"Stockton-on-Tees\"],mayoralty:\"Tees Valley\",twitter:\"https: //twitter.com/intent/tweet?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20the%20Tees%20Valley%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3&url=www.culturecommons.uk%2Fpledge\",facebook:\"https: //www.facebook.com/sharer/sharer.php?u=www.culturecommons.uk%2Fpledge?utm_source=facebook&utm_medium=social&utm_campaign=_fb\",whatsapp:\"https: //api.whatsapp.com/send?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20the%20Tees%20Valley%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3www.culturecommons.uk%2Fpledge\",cc:[\"example1@email.com\",\"example2@email.com\",\"example3@email.com\"],emailSubject:\"Will you support the creative industries in the Tees Valley?\"},{districts:[\"Barking and Dagenham\",\"Barnet\",\"Bexley\",\"Brent\",\"Bromley\",\"Camden\",\"Croydon\",\"Ealing\",\"Enfield\",\"Greenwich\",\"Hackney\",\"Hammersmith and Fulham\",\"Haringey\",\"Harrow\",\"Havering\",\"Hillingdon\",\"Hounslow\",\"Islington\",\"Kensington and Chelsea\",\"Kingston upon Thames\",\"Lambeth\",\"Lewisham\",\"Merton\",\"Newham\",\"Redbridge\",\"Richmond upon Thames\",\"Southwark\",\"Sutton\",\"Tower Hamlets\",\"Waltham Forest\",\"Wandsworth\",\"Westminster\",\"City of London\"],mayoralty:\"London\",twitter:\"https: //twitter.com/intent/tweet?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20London%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3&url=www.culturecommons.uk%2Fpledge\",facebook:\"https: //www.facebook.com/sharer/sharer.php?u=www.culturecommons.uk%2Fpledge?utm_source=facebook&utm_medium=social&utm_campaign=_fb\",whatsapp:\"https: //api.whatsapp.com/send?text=I've%20just%20asked%20every%20mayoral%20candidate%20in%20London%20to%20pledge%20to%20protect%20our%20cultural%20industries.%20Join%20me%20and%20send%20an%20email%20now%20%F0%9F%93%A3www.culturecommons.uk%2Fpledge\",cc:[\"example1@email.com\",\"example2@email.com\",\"example3@email.com\"],emailSubject:\"Will you support the creative industries in London\"}];","export default (\n  mayoralty,\n  firstName,\n  lastName,\n  email,\n  postcode\n) => `Dear ${mayoralty} Mayoral Candidates,\n  \nThe creative and cultural sector has been seriously impacted by the national response to the pandemic. Workers in the creative industries â€“ often mixing short-term freelance contracts and employed work in the public, private and third sector - have seen their income dramatically reduce over the past year, particularly those working in live arts and venue-based workplaces. Many of the highly skilled and highly trained people in who keep our city region vibrant and dynamic have fallen through the gaps in the furlough and Self-Employed lncome Support schemes, receiving little or even no help.\n\nYet all of us have depended on the work of the creative sector to get us through these difficult times. How would we have managed without books, music, TV and radio broadcasts, box sets, films, computer games, and digital streaming of thousands of live performances during the endless hours of lockdown? And how many of us long to see live performances again, in our local theatres, concert halls, stadiums and festivals?\n\nNow, more than ever, we need to value, respect and support our cultural industries workforce as we emerge from the pandemic together. In the months and years ahead, the incoming Metro Mayor for our area will need to lead a rebuilding of our regional economy. We must place the creative and cultural sector at the very heart of that recovery; by increasing employment and economic activity, but also spurring innovation, promoting diversity and making a positive social impact on health, well-being, education, inclusion and urban regeneration.\n\nAs a candidate running to be the Metro Mayor, I make this pledge to the creative and cultural industries workforce in my city region:\n\nYours sincerely,\n\n${firstName} ${lastName}\n${email}\n${postcode}`\n","import mayoralties from \"./mayoralties.json\"\nimport emailTemplate from \"./email-template\"\n\nconst form = document.querySelector(\"#rw-postcode-lookup-form\")\nconst gravityForm = document.querySelector(\".gf-form\")\n\nif (form && gravityForm) {\n  // hide the gravity form\n  gravityForm.style.display = \"none\"\n\n  form.addEventListener(\"submit\", async e => {\n    try {\n      e.preventDefault()\n\n      const formData = new FormData(form)\n\n      const firstName = formData.get(\"first_name\")\n      const lastName = formData.get(\"last_name\")\n      const email = formData.get(\"email\")\n      const postcode = formData.get(\"postcode\")\n\n      const res = await fetch(`https://api.postcodes.io/postcodes/${postcode}`)\n      const {\n        result: { admin_district },\n      } = await res.json()\n\n      const mayoralty = mayoralties.find(m => {\n        return m.districts.includes(admin_district)\n      })\n\n      if (mayoralty) {\n        // 1. insert values\n        document.querySelector(\n          \".gf-name input[aria-label='First name']\"\n        ).value = firstName\n        document.querySelector(\n          \".gf-name input[aria-label='Last name']\"\n        ).value = lastName\n        document.querySelector(\n          \".gf-postcode input[type='text']\"\n        ).value = postcode\n        document.querySelector(\".gf-email input[type='text']\").value = email\n        document.querySelector(\n          \".gf-candidate-emails input\"\n        ).value = mayoralty.cc.join(\",\")\n        document.querySelector(\".gf-message textarea\").value = emailTemplate(\n          mayoralty.mayoralty,\n          firstName,\n          lastName,\n          email,\n          postcode\n        )\n        // 2. make gravity form visible again\n        gravityForm.style.display = \"block\"\n      } else {\n        // handle no elections\n        gravityForm.style.display = \"none\"\n        form.innerHTML += `<p class=\"rw-message\">Sorry, you don't live in an area holding a Metro Mayoral election this May. You can still help by spreading the word - use the buttons below to ask your friends to email their candidates!</p>`\n      }\n    } catch (e) {\n      // handle other errors\n      console.log(e)\n      form.innerHTML += `<p class=\"rw-message\">There was a problem. Please refresh the page or try again later.</p>`\n    }\n  })\n}\n"]}